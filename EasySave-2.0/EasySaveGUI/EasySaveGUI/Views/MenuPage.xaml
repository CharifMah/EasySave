<Page
    x:Class="EasySaveGUI.Views.MenuPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Converter="clr-namespace:EasySaveGUI.Converters"
    xmlns:Ressources="clr-namespace:Ressources;assembly=Ressources"
    xmlns:Usr="clr-namespace:EasySaveGUI.UserControls"
    xmlns:Validator="clr-namespace:EasySaveGUI.ValidationRules"
    xmlns:WpfToolKit="http://schemas.xceed.com/wpf/xaml/toolkit"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:EasySaveGUI.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="MenuPage"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <Page.Resources>
        <Converter:ETypeBackupConverter x:Key="ETypeBackupConverter" />
        <Converter:BytesValueConverter x:Key="BytesValueConverter" />
    </Page.Resources>

    <!--  Main Content  -->
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="0.059*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Usr:ValidationPopupControl
            x:Name="PopupError"
            Grid.ColumnSpan="2"
            Panel.ZIndex="2"
            DataContext="{Binding PopupVm}" />
        <Grid
            Grid.Row="1"
            Grid.Column="0"
            Background="#CEE6FD">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Button
                Grid.Row="0"
                Content="{x:Static Ressources:Strings.LoadJobs}"
                MouseEnter="ListElementsButton_MouseEnter"
                Style="{StaticResource CustomButton}" />
        </Grid>

        <DockingManager
            x:Name="Dock"
            Grid.Row="1"
            Grid.Column="1"
            Background="#EDF5FD">
            <DockingManager.Theme>
                <Vs2013LightTheme />
            </DockingManager.Theme>
            <!--  Content  -->
            <DockingManager.Layout>
                <LayoutRoot>
                    <LayoutPanel Orientation="Horizontal">

                        <!--  Elements Pane Left  -->
                        <!--  MenuButtons  -->
                        <LayoutAnchorablePane AllowDuplicateContent="False" DockMinWidth="150">

                            <LayoutAnchorable
                                x:Name="ListElements"
                                Title="Elements"
                                CanAutoHide="False"
                                CanClose="False">
                                <!--  MenuButtons  -->
                                <StackPanel VerticalAlignment="Center">
                                    <Button
                                        Click="LoadConfigDefaultFileButton_Click"
                                        Content="{x:Static Ressources:Strings.DefaultFile}"
                                        Style="{StaticResource CustomButtonFile}" />
                                    <Button
                                        Click="LoadConfigFileButton_Click"
                                        Content="{x:Static Ressources:Strings.SelectConfigurationFile}"
                                        Style="{StaticResource CustomButtonFile}" />
                                    <Button
                                        Click="SaveConfigFileButton_Click"
                                        Content="{x:Static Ressources:Strings.SaveConf}"
                                        Style="{StaticResource CustomButtonFile}" />
                                    <Button
                                        Click="ApplyDefaultStyleButton_Click"
                                        Content="{x:Static Ressources:Strings.ApplyDefaultStyle}"
                                        Style="{StaticResource CustomButtonApplyDefaultStyle}" />
                                </StackPanel>
                            </LayoutAnchorable>

                        </LayoutAnchorablePane>

                        <LayoutPanel Orientation="Vertical">
                            <!--  Jobs Pane  -->
                            <LayoutPanel Orientation="Horizontal">

                                <!--  Jobs Pane  -->
                                <LayoutDocumentPaneGroup DockWidth="200" Orientation="Vertical">
                                    <!--  jobs list  -->
                                    <LayoutDocumentPane x:Name="JobsPaneGroup">
                                        <LayoutDocument Title="Jobs" CanClose="False">
                                            <ListBox
                                                x:Name="JobsList"
                                                ItemsSource="{Binding JobVm.Jobs, Mode=TwoWay}"
                                                SelectionMode="Multiple">
                                                <ListBox.Resources>
                                                    <Style TargetType="ListBoxItem">
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="ListBoxItem">
                                                                    <CheckBox
                                                                        Margin="5,2"
                                                                        Checked="CheckBox_Checked"
                                                                        IsChecked="{Binding IsSelected, RelativeSource={RelativeSource TemplatedParent}}">
                                                                        <ContentPresenter />
                                                                    </CheckBox>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </ListBox.Resources>
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <WrapPanel Orientation="Horizontal">
                                                            <StackPanel>
                                                                <TextBlock>
                                                                    <Run Text="{x:Static Ressources:Strings.Name}" />
                                                                    <Run Text=" : " />
                                                                    <Run Text="{Binding Name}" />
                                                                </TextBlock>
                                                                <TextBlock>
                                                                    <Run Text="{x:Static Ressources:Strings.SourceDirectory}" />
                                                                    <Run Text="{Binding SourceDirectory}" />
                                                                </TextBlock>
                                                                <TextBlock>
                                                                    <Run Text="{x:Static Ressources:Strings.TargetDirectory}" />
                                                                    <Run Text="{Binding TargetDirectory}" />
                                                                </TextBlock>
                                                                <TextBlock>
                                                                    <Run Text="{x:Static Ressources:Strings.Type}" />
                                                                    <Run Text=" : " />
                                                                    <Run Text="{Binding BackupType, Mode=TwoWay, Converter={StaticResource ETypeBackupConverter}}" />
                                                                </TextBlock>
                                                            </StackPanel>
                                                        </WrapPanel>
                                                        <!--</CheckBox>-->
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                        </LayoutDocument>

                                        <!--  JobsRunning  -->
                                        <LayoutDocument
                                            x:Name="JobsRunningDocument"
                                            Title="JobsRunning"
                                            CanClose="False">
                                            <DataGrid
                                                x:Name="dataGrid"
                                                AutoGenerateColumns="False"
                                                ItemsSource="{Binding JobVm.JobsRunning}"
                                                Style="{StaticResource CustomDataGrid}">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Binding="{Binding Path=Name}" Header="Nom" />

                                                    <DataGridTemplateColumn Header="Progress">
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <ProgressBar
                                                                    x:Name="MyProgressBar"
                                                                    MinWidth="200"
                                                                    HorizontalAlignment="Stretch"
                                                                    VerticalAlignment="Stretch"
                                                                    Maximum="100"
                                                                    Value="{Binding Path=SauveJobs.LogState.Progress, Mode=TwoWay}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>

                                                    </DataGridTemplateColumn>

                                                    <!--  LogSstate Column Datagrid JobsRunning  -->
                                                    <DataGridTemplateColumn Header="LogState">
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <!--  LogSstate  -->
                                                            <DataTemplate>
                                                                <StackPanel>
                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock FontWeight="Bold" Text="Fichiers restants : " />

                                                                        <TextBlock Text="{Binding Path=SauveJobs.LogState.RemainingFiles, Mode=OneWay}" />
                                                                    </StackPanel>

                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock FontWeight="Bold" Text="Octets copiés : " />

                                                                        <TextBlock Text="{Binding Path=SauveJobs.LogState.BytesCopied, Mode=OneWay, Converter={StaticResource BytesValueConverter}}" />
                                                                    </StackPanel>

                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock FontWeight="Bold" Text="SourceDirectory : " />

                                                                        <TextBlock Text="{Binding Path=SauveJobs.LogState.SourceDirectory, Mode=OneWay}" />
                                                                    </StackPanel>

                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock FontWeight="Bold" Text="TargetDirectory : " />

                                                                        <TextBlock Text="{Binding Path=SauveJobs.LogState.TargetDirectory, Mode=OneWay}" />
                                                                    </StackPanel>

                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock FontWeight="Bold" Text="EligibleFileCount : " />

                                                                        <TextBlock Text="{Binding Path=SauveJobs.LogState.EligibleFileCount, Mode=OneWay}" />
                                                                    </StackPanel>

                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock FontWeight="Bold" Text="ElapsedMilisecond : " />

                                                                        <TextBlock Text="{Binding Path=SauveJobs.LogState.ElapsedMilisecond, Mode=OneWay}" />
                                                                    </StackPanel>

                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock FontWeight="Bold" Text="IsActive : " />

                                                                        <TextBlock Text="{Binding Path=SauveJobs.LogState.IsActive, Mode=OneWay}" />
                                                                    </StackPanel>

                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock FontWeight="Bold" Text="TotalSize : " />

                                                                        <TextBlock Text="{Binding Path=SauveJobs.LogState.TotalSize, Mode=OneWay}" />
                                                                    </StackPanel>

                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock FontWeight="Bold" Text="Derniere activitée : " />

                                                                        <TextBlock Text="{Binding Path=SauveJobs.LogState.Date, Mode=OneWay}" />
                                                                    </StackPanel>


                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock FontWeight="Bold" Text="TotalTransferedFile : " />

                                                                        <TextBlock Text="{Binding Path=SauveJobs.LogState.TotalTransferedFile, Mode=OneWay}" />
                                                                    </StackPanel>
                                                                </StackPanel>
                                                            </DataTemplate>

                                                        </DataGridTemplateColumn.CellTemplate>
                                                    </DataGridTemplateColumn>

                                                    <DataGridTextColumn Binding="{Binding Path=SourceDirectory}" Header="Répertoire source" />

                                                    <DataGridTextColumn Binding="{Binding Path=TargetDirectory}" Header="Répertoire cible" />

                                                </DataGrid.Columns>

                                            </DataGrid>
                                        </LayoutDocument>

                                    </LayoutDocumentPane>

                                </LayoutDocumentPaneGroup>

                                <!--  Property Pane  -->
                                <LayoutAnchorablePaneGroup DockWidth="200">

                                    <!--  Property Pane  -->
                                    <LayoutAnchorablePane DockMinWidth="200">
                                        <!--  Property Pane  -->
                                        <LayoutAnchorable
                                            x:Name="PropertyPane"
                                            Title="Property"
                                            CanClose="False"
                                            CanHide="False">

                                            <Grid>
                                                <Usr:JobPropertyControl x:Name="JobPropertyUsr" />

                                                <StackPanel VerticalAlignment="Bottom">
                                                    <Button
                                                        x:Name="ButtonRunJobs"
                                                        Click="RunJobsButton_Click"
                                                        Content="{x:Static Ressources:Strings.RunJobs}"
                                                        Style="{StaticResource CustomButtonRun}" />

                                                    <Button
                                                        x:Name="ButtonDeletesJobs"
                                                        Click="ButtonDeletesJobs_Click"
                                                        Content="{x:Static Ressources:Strings.DeleteJob}"
                                                        Style="{StaticResource CustomButtonDelete}" />

                                                    <Button
                                                        x:Name="Clear"
                                                        Click="Clear_Click"
                                                        Content="{x:Static Ressources:Strings.ClearConsole}"
                                                        Style="{StaticResource CustomButtonClear}" />
                                                </StackPanel>
                                            </Grid>

                                        </LayoutAnchorable>

                                    </LayoutAnchorablePane>

                                    <!--  CreateJob Pane  -->
                                    <LayoutAnchorablePane DockMinWidth="200">

                                        <LayoutAnchorable
                                            x:Name="LayoutAnchorableCreateJob"
                                            Title="CreateJob"
                                            AutoHideMinWidth="200"
                                            CanClose="False"
                                            CanHide="False"
                                            CanShowOnHover="False">
                                            <Usr:CreateJobControl />
                                        </LayoutAnchorable>

                                    </LayoutAnchorablePane>

                                </LayoutAnchorablePaneGroup>

                            </LayoutPanel>

                            <!--  Logs  -->
                            <LayoutAnchorablePaneGroup DockHeight="120" Orientation="Horizontal">

                                <!--  Logs  -->
                                <LayoutAnchorablePane>

                                    <LayoutAnchorable
                                        Title="Daily Logs"
                                        CanClose="False"
                                        CanHide="False">

                                        <DockPanel x:Name="DockPanelListDailyLogs">
                                            <TextBlock DockPanel.Dock="Top" FontWeight="Bold">
                                                <Run Text="Count Logs : " />
                                                <Run Text="{Binding Datas.Count, Mode=OneWay}" />
                                            </TextBlock>
                                            <DataGrid
                                                x:Name="ListLogsDaily"
                                                IsReadOnly="True"
                                                ItemsSource="{Binding Datas, Mode=OneWay}"
                                                Style="{StaticResource CustomDataGrid}" />
                                        </DockPanel>

                                    </LayoutAnchorable>
                                </LayoutAnchorablePane>

                                <LayoutAnchorablePane>

                                    <LayoutAnchorable
                                        Title="All Logs"
                                        CanClose="False"
                                        CanHide="False">

                                        <DockPanel x:Name="DockPanelListLogs">
                                            <TextBlock DockPanel.Dock="Top" FontWeight="Bold">
                                                <Run Text="Count Logs : " />
                                                <Run Text="{Binding Datas.Count, Mode=OneWay}" />
                                            </TextBlock>
                                            <ListBox x:Name="ListLogs" ItemsSource="{Binding Datas, Mode=OneWay}" />
                                        </DockPanel>


                                    </LayoutAnchorable>

                                </LayoutAnchorablePane>

                            </LayoutAnchorablePaneGroup>

                        </LayoutPanel>

                    </LayoutPanel>
                </LayoutRoot>
            </DockingManager.Layout>

        </DockingManager>

    </Grid>

</Page>
